(this.webpackJsonp=this.webpackJsonp||[]).push([[923],{YbnA:function(e,t,i){"use strict";i.r(t),i.d(t,"EditorMarkdownPreviewExtension",(function(){return c}));var o=i("4pZC"),n=i.n(o),r=(i("uHfJ"),i("R0RX"),i("CzEs")),s=i("8WR8"),h=i("mNEC"),v=i("BYh8"),w=i("mphk"),a=i("7dTA"),l=i("6kPI");class c{static get extensionName(){return"EditorMarkdownPreview"}onSetup(e,t){this.preview={el:void 0,actions:{preview:void 0,hide:void 0},shown:!1,modelChangeListener:void 0,path:t.previewMarkdownPath,actionShowPreviewCondition:e.createContextKey("toggleLivePreview",!0),eventEmitter:new r.Emitter},this.toolbarButtons=[],this.setupPreviewAction(e);const i=n()((function(t){for(const o of t){var i;const{width:t}=o.contentRect;if(null!==(i=e.markdownPreview)&&void 0!==i&&i.shown){const i=t*l.y;c.resizePreviewLayout(e,i)}}}),50);this.resizeObserver=new ResizeObserver(i),this.preview.eventEmitter.event(this.togglePreview.bind(this,e))}onBeforeUnuse(e){this.cleanup(e);const t=this.toolbarButtons.map((function(e){return e.id}));e.toolbar&&e.toolbar.removeItems(t)}cleanup(e){this.resizeObserver.disconnect(),this.preview.modelChangeListener&&this.preview.modelChangeListener.dispose(),this.preview.actions.preview.dispose(),this.preview.actions.hide.dispose(),this.preview.shown&&(this.togglePreviewPanel(e),this.togglePreviewLayout(e)),this.preview.shown=!1}static resizePreviewLayout(e,t){const{height:i}=e.getLayoutInfo();e.layout({width:t,height:i})}togglePreviewLayout(e){const{width:t}=e.getLayoutInfo();let i;this.preview.shown?(i=t/l.y,this.resizeObserver.disconnect()):(i=t*l.y,this.resizeObserver.observe(e.getContainerDomNode())),c.resizePreviewLayout(e,i)}togglePreviewPanel(e){const t=e.getDomNode().parentElement,{el:i}=this.preview;t.classList.toggle(l.x),"none"===i.style.display?this.fetchPreview(e):i.style.display="none"}fetchPreview(e){const{el:t}=this.preview;var i,o;(i=e.getValue(),o=this.preview.path,w.a.post(o,{text:i}).then((function({data:e}){return e.body}))).then((function(e){t.innerHTML=Object(v.b)(e),Object(a.a)(t.querySelectorAll(".js-syntax-highlight")),t.style.display="block"})).catch((function(){return Object(h.createAlert)(s.b)}))}setupPreviewAction(e){if(e.getAction(l.t))return;const t={keybindings:[r.KeyMod.chord(r.KeyMod.CtrlCmd|r.KeyMod.Shift|r.KeyCode.KEY_P)],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run(e){e.togglePreview()}};this.preview.actions.preview=e.addAction({...t,id:l.t,label:l.v,precondition:"toggleLivePreview"}),this.preview.actions.hide=e.addAction({...t,id:l.u,label:l.s,precondition:"!toggleLivePreview"})}togglePreview(e){var t,i,o;null!==(t=this.preview)&&void 0!==t&&t.el||(this.preview.el=function({injectToEl:e=null}={}){const t=document.createElement("div");return t.classList.add(l.w),t.style.display="none",e&&e.appendChild(t),t}({injectToEl:e.getDomNode().parentElement})),this.togglePreviewLayout(e),this.togglePreviewPanel(e),this.preview.actionShowPreviewCondition.set(!this.preview.actionShowPreviewCondition.get()),null!==(i=this.preview)&&void 0!==i&&i.shown?this.preview.modelChangeListener.dispose():this.preview.modelChangeListener=e.onDidChangeModelContent(n()(this.fetchPreview.bind(this,e),l.z)),this.preview.shown=!(null!==(o=this.preview)&&void 0!==o&&o.shown),e.toolbar&&e.toolbar.updateItem(l.t,{selected:this.preview.shown})}provides(){var e=this;return{markdownPreview:this.preview,fetchPreview:function(t){return e.fetchPreview(t)},setupPreviewAction:function(t){return e.setupPreviewAction(t)},togglePreview:function(t){return e.togglePreview(t)}}}}}}]);
//# sourceMappingURL=923.5108551c.chunk.js.map